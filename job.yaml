$schema: https://azuremlschemas.azureedge.net/latest/commandJob.schema.json
type: command

compute: ML-compute
code: .

environment:
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu20.04
  conda_file: ./azureml/environment/conda.yaml


# Inputs
inputs:
  data_config:
    type: uri_file
    path: ./azureml/configs/data.json
  training_config:
    type: uri_file
    path: ./azureml/configs/training.json
  model_config:
    type: uri_file
    path: ./azureml/configs/model.json

# Command to run
command: >
  python ./azureml/scripts/train.py
  --data_config ${{inputs.data_config}}
  --training_config ${{inputs.training_config}}
  --model_config ${{inputs.model_config}}
  --output_dir ${{outputs.adapters}}

# Outputs
outputs:
  adapters:
    type: uri_folder
